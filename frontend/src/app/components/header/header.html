<!-- Top marquee (seamless, duplicated tracks) -->
<div class="top-marquee" aria-label="store updates">
  <div class="track">
    <span>Love is a timeless gift â™¡</span>
    <span>Worldwide shipping â€” 3-day exchanges</span>
    <span>Personal WhatsApp concierge</span>
    <span>Secure payments</span>
    <span>Free returns on defects</span>
  </div>
  <div class="track track--dup" aria-hidden="true">
    <span>Love is a timeless gift â™¡</span>
    <span>Worldwide shipping â€” 3-day exchanges</span>
    <span>Personal WhatsApp concierge</span>
    <span>Secure payments</span>
    <span>Free returns on defects</span>
  </div>
</div>

<header class="header">
  <a routerLink="/" class="logo" routerLinkActive="active" [routerLinkActiveOptions]="{ exact:true }">DEEP TIME</a>

  <nav class="nav" [class.open]="mobileOpen()">
    <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact:true }">Home</a>
    <a routerLink="/#new">New</a>
    <a routerLink="/#men">Men</a>
    <a routerLink="/#women">Women</a>
    <a routerLink="/#sell">Sell Your Watch</a>

    <ng-container *ngIf="user$ | async as u">
      <a *ngIf="u?.role === 'admin'"
         class="admin-link"
         routerLink="/admin"
         routerLinkActive="active">Admin</a>
    </ng-container>
  </nav>

  <div class="right">
    <a class="nav-cart" routerLink="/cart" aria-label="Cart">
      <span class="icon" aria-hidden="true">ðŸ‘œ</span>
      <span class="badge" *ngIf="(count$ | async) as c" [class.hide]="!c">{{ c }}</span>
    </a>

    <ng-container *ngIf="!(user$ | async); else loggedIn">
      <a class="btn ghost" routerLink="/login">Sign in</a>
      <a class="btn gold"  routerLink="/register">Register</a>
    </ng-container>

    <ng-template #loggedIn>
      <div class="userbox">
        <ng-container *ngIf="user$ | async as u">
          <span class="role" [class.admin]="u.role==='admin'">{{ u.role }}</span>
          <button class="avatar" (click)="toggleMenu()" aria-haspopup="menu" [attr.aria-expanded]="menuOpen()">
            {{ initial(u.email) }}
          </button>

          <div class="menu" *ngIf="menuOpen()" role="menu">
            <div class="info">
              <div class="email">{{ u.email }}</div>
              <div class="muted">Signed in</div>
            </div>
            <a routerLink="/profile" (click)="closeMenu()" role="menuitem">Profile</a>
            <a *ngIf="u.role==='admin'" routerLink="/admin" (click)="closeMenu()" role="menuitem">Admin</a>
            <button (click)="logout()" role="menuitem">Logout</button>
          </div>
        </ng-container>
      </div>
    </ng-template>

    <button class="hamburger" (click)="toggleMobile()" aria-label="Menu" [attr.aria-expanded]="mobileOpen()">
      <span></span><span></span><span></span>
    </button>
  </div>
</header>
